<a href="../README.md"><= Επιστροφή</a><br>
  
Αρχικός Σχεδιασμός
==================

Θα κατασκευάσουμε μια μακέτα θερμοκηπίου από νάυλον διαστάσεων περίπου 120cm x 60cm x95cm. Μέσα θα τοποθετηθούν όλα τα εξαρτήματα και οι συσκευές που χρησιμοποιούνται σε ένα πραγματικό θερμοκήπιο. Συγκεκριμένα θα βάλουμε τα εξής:  
1.	Στοιχεία θέρμανσης του αέρα
2.	Αυτόματο πότισμα
3.  Εξαερισμό με ανεμιστήρες
4.  Σύστημα αυτόματης σκίασης
5.  Σύστημα ελέγχου των παραθύρων

Ένα πλήθος αισθητήρων θα τροφοδοτεί με δεδομένα τον κεντρικό Η/Υ ώστε να λαμβάνονται οι αποφάσεις για τον έλεγχο των παραπάνω συσκευών. Θα τοποθετήσουμε αισθητήρες:
1.  Θερμοκρασίας
2.  Ηλιοφάνειας
3.  PH
4.  Ποτίσματος
5.  Υγρασίας αέρα

<p>Στην φωτογραφία φαίνονται οι αισθητήρες που χρησιμοποιήσαμε στο θερμοκήπιο:</p>
<p align="center"><img src="/resources/images/sensors.png" width="700"></p>

Μέσα στο σπογγώδες υπόστρωμα θα φυτέψουμε φυτά ώστε να κάνουμε τις δοκιμές μας σε πραγματικές συνθήκες.

Επειδή το θερμοκήπιο μπορεί να είναι απομακρυσμένο και να μην υπάρχει δυνατότητα σύνδεσης με το διαδίκτυο (εκτός από δίκτυα 3G-4G-5G τα οποία έχουν και το ανάλογο κόστος χρήσης), θα χρησιμοποιήσουμε το σύστημα μετάδοσης LO.RA. για την επικοινωνία με τον 2ο χώρο π.χ. το σπίτι του παραγωγού, όπου θα υπάρχει σύνδεση με το διαδίκτυο. Το σύστημα LO.RA. μπορεί να καλύψει μεγάλες αποστάσεις (έως 30Km) για χαμηλούς ρυθμούς μετάδοσης. Επειδή το θερμοκήπιό μας δεν στέλνει και πολλά δεδομένα από τους αισθητήρες του, το πρωτόκολλο LORA WAN είναι ιδανικό. Σήμερα λειτουργούν αρκετά δίκτυα LORA WAN σε όλο τον κόσμο και χρησιμοποιούνται σε συστήματα IOT όταν είναι απομακρυσμένα και θέλουμε χαμηλή κατανάλωση ενέργειας.  

<p align = "center">
<img src="/resources/images/BlockDiagram_1.png" width="700">
</p>

Όπως φαίνεται στο σχήμα στο θερμοκήπιο (Χώρος Β') υπάρχουν όλοι οι αισθητήρες και οι ενεργοποιητές οι οποίοι συνδέονται σ' ένα arduino. Επίσης στο arduino συνδέεται ένα άρθρωμα LORA το οποίο στέλνει τα δεδομένα και δέχεται εντολές από τον κεντρικό υπολογιστή ο οποίος βρίσκεται στον χώρο Α'. Ο κώδικας στο arduino θα γραφτεί σε Wiring. Τα δεδομένα είναι κωδικοποιημένα και κρυπτογραφημένα σύμφωνα με το πρωτόκολλο LORA WAN. 

Από την άλλη πλευρά (Χώρος Α΄), υπάρχει μια απλή πύλη LORA WAN η οποία στέλνει τα δεδομένα στο διαδίκτυο με το πρωτόκολλο MQTT. Στη πύλη μπορούν να συνδεθούν περισσότερα θερμοκήπια και να διαχειρίζονται από το ίδιο ή διαφορετικούς servers. Το λογισμικό της πύλης ενώ αρχικά το γράψαμε σε micropython, παρουσιάστηκαν προβλήματα καθυστέρησης και εδώ οι χρόνοι είναι κρίσιμοι. Έτσι το μεταφέραμε και αυτό σε wiring. 

Τέλος ο εξυπηρετητής μπορεί να είναι οποιοσδήποτε υπολογιστής με Linux, στον οποίο θα τρέχει το mosquitto (MQTT Broker) και το Node Red. Εδώ μπορούμε να προσθέσουμε και μερικά δικά μας script σε Python τα οποία θα ακούν ή θα δημοσιεύουν σε mqtt topics. Εμείς για εξυπηρετητή σκοπεύουμε να χρησιμοποιήσουμε ένα Raspberry PI 3 ή 4.

Τελική υλοποίηση
================
  
Το υλικό ελέγχου έχει χωριστεί σε τρία μέρη:

1. Κεντρικός διακομιστής
Ο διακομιστής μας θα είναι ένα Raspberry PI 4 στο οποίο θα εγκατασταθούν τα πακέτα: Mosquitto MQTT broker, Node Red και Network Server το οποίο γράψαμε σε Python 3. Το Raspberry μπορεί να βρίσκεται οπουδήποτε αρκεί να υπάρχει σύνδεση με το διαδίκτυο, να έχουν ανοίξει οι συγκεκριμένες πόρτες του router και να κατευθύνονται στο Raspberry. Επίσης αν έχουμε δυναμική απόδοση διεύθυνσης IP, πρέπει να φαίνεται στον έξω κόσμο μέσω κάποιου παρόχου δυναμικού DNS π.χ. FreeDNS, DynDNS κλπ. Εναλλακτικά μπορούμε να βάλουμε ένα PC με Linux ή να νοικιάσουμε κάποιο VPS με Linux.

2. Πύλη επικοινωνίας LoRa Wan Lite
Η πύλη LoRa είναι μια διαφανής πύλη η οποία λαμβάνει πλαίσια LoRa WAN από τους ελεγκτές θερμοκηπίων - κόμβους και τα προωθεί στο διαδίκτυο και συγκεκριμένα στο Raspberry Pi 4 ή τον διακομιστή τον οποίο στήσαμε στην προηγούμενη παράγραφο. Επίσης παίρνει πακέτα από τον διακομιστή και τα προωθεί στους ελεγκτές - κόμβους. Η πύλη τοποθετείται οπουδήποτε αρκεί να έχει πρόσβαση στο διαδίκτυο. Επειδή τα θερμοκήπια μπορεί να είναι αρκετά μακριά, η πύλη μπορεί να εγκατασταθεί στο σπίτι του παραγωγού.

3. Ελεγκτής θερμοκηπίου - Κόμβος
Οι κόμβοι μπορούν να βρίσκονται σε διαφορετικά μέρη και σε απόσταση μέχρι 20Km από την πύλη αρκεί να μην υπάρχουν πολλά φυσικά εμπόδια όπως κτίρια ή βουνά.

Το έργο μπορεί να χρησιμοποιηθεί ως εποπτικό μέσο για την διδασκαλία των τεχνολογιών IOT σε μαθητές των τομέων Πληροφορικής, Ηλεκτρονικής - Ηλεκτρολογίας καθώς και για την μελέτη σύγχρονων καλλιεργητικών μεθόδων από μαθητές του τομέα Γεωπονίας και Τροφίμων.
<br><br>
<a href="../README.md"><= Επιστροφή</a><br>
